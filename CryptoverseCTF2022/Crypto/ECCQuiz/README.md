## ECC Quiz

### Challenge Description

Elliptic Curve Cryptography (ECC) is a method of public-key cryptography based on the algebraic structure of elliptic curves over finite fields. Learning ECC is important for both CTFs and real-world applications. This challenge is a quiz to test your knowledge of ECC.  

Note: I highly recommend reading over the [CryptoHack Course](https://cryptohack.org/courses/elliptic/course_details/) before attempting this challenge if you have no prior knowledge of ECC. You should be able to solve the challenge by understanding the course!  

```
nc 137.184.215.151 22666
```  


### Writeup
We are given a server address and It asks us 3 questions about ECC.  
We can use `Sage` python library for calculations.  
Create a Sage project in [CoCalc](https://cocalc.com/) and you will be able to run codes bellow.  

Question 1:  
```python
# Given
p = 10567
a = 430
b = 6848
p1 = (2707, 6228)
n = 6981

E = EllipticCurve(GF(p),[a,b])
P = E(p1)

# Question: nP
n*P

# res: (10351 : 8475 : 1)
```   
Question 2:   
```python
# Given
p = 42073406175612447276591828455539443548785395065774015748446170767146608921500492043416278473795355696411833133782753236715062556140188162766898227624222224120638059766025576218308533385383
m=(21586382730715813492611224383785635367779836224880267192937940355975905657802907294482124129259680602625625757172639384014835112968714904124254432557752647494286222869761986821045622180418, 25907152627094255795203291825606953162832950407942273818145967293228609047030724435011529501137311341517666740128809869326224921821477308855827052699390433623463737451430619423497563495176)
n=(5835546752683116960352732387200492599074248026905097126234312541359555151348096092671848922801882584269179716056056525774976944967483760531057736578849520880628129799240925138214754620297, 35128239873085237516651993773129879038314103861361087186446551608840187440555418422111295101132443757809858801318282634404364750688870495729296874382957382408518893518258160735007101630390)

# Question: (a,b)
# equation: y^2 = x^3 + ax + b
# We know that having t points we can calculate (a,b) for a t-1 degree equation. 
# Here we have 2 points given. So we can not directly calculate (a,b) for y^2 = x^3 + ax + b
# But we can calculate it for y^2 - x^3 = ax + b

mm = (m[0], m[1]*m[1]- m[0]*m[0]*m[0])
nn = (n[0], n[1]*n[1]- n[0]*n[0]*n[0])

F.<x> = PolynomialRing(GF(p))
points=[mm,nn]

F.lagrange_polynomial(points)

# answer : (12151214193469513475337895137416235515014525529160163279900743297238109241753591189609734693438334389351229539029033156340368481855410469385344798660650622256808263218359445947630273280273, 18066699972038815430159271246824526528133643697959219107367573264684066030341361474275150158838263306292371992300668618690863238504604306662123941498554398313280309619817261360258669964052)
```  
Question 3:
```python
p = 966046176171188355440285322709
a = 412965006802761954004799266747
b = 375341519864548123199330679756
P = (506216131011724415511126705750, 320551482312399015795564998122)
Q = (314861212087311558986415655745, 427162654635383832687938118423)

E = EllipticCurve(GF(p),[a,b])
P = E(P)
Q = E(Q)

# Question: We know that Q = uP. Find u. 
for i in range(1,p):
    if(i*P == Q):
        print(i)
        break

# res: 3329
```

