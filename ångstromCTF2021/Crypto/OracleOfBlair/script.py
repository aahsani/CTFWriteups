import socket

h = "crypto.2021.chall.actf.co"
p = 21112

FLAG_LEN = 25

resultList = []
resultList.append(ord("a"))
resultList.append(ord("c"))
resultList.append(ord("t"))
resultList.append(ord("f"))

def printFlag():
    r = ""
    for i in resultList:
        r += chr(i)
    print(r)

def getResFlag():
    r = ""
    for i in resultList:
        r += hex(i)[2:]
    return r

def process_result(res, a1, a3, byte):
    blocksLen = int(int(len(res) / 2) / 16)
    blocks = []
    start = 0
    end = 32
    for i in range(0, blocksLen):
        blocks.append(res[start:end])
        start = start + 32
        end = end + 32
    r1 = int(blocks[2], 16) ^ int(a1, 16)
    r2 = int(blocks[4], 16) ^ int(a3, 16)
    if (r1 == r2):
        resultList.append(byte)
        print("^^^^^^^^^^^^^^^^^^^^^^^^^^")
        print(printFlag())
        return True
    return False
    

def generate_input(counter, byte):
    res = "0" * 32
    res += "0" * (32 - counter) * 2
    for i in resultList:
        res += hex(i)[2:]
    if (len(hex(byte)) == 3): res += "0"
    res += hex(byte)[2:]
    res += "0" * (32 - counter) * 2
    res += "7b7d"
    return res


def nc(hn, p):
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    sock.connect((hn, p))
    counter = 5
    byte = 0
    data = sock.recv(1024)
    res = data.decode().strip()
    answer = "0" * 16 * 2 + "0" * 27 * 2 + str(hex(ord('a')))[2:] + str(hex(ord('c')))[2:] +str(hex(ord('t')))[2:] +str(hex(ord('f')))[2:] + str(hex(ord('{')))[2:] + "0" * 27 * 2 + "7b7d\n"
    a1 = answer[32:64]
    a3 = answer[96:128]
    sock.sendall(answer.encode())
    byte = 123 # {

    while True:
        res = ""
        data = sock.recv(1024)
        res = data.decode().strip()
        f = process_result(res.split("\n")[0], a1, a3, byte)
        if(f):
            byte = 0
            counter = counter + 1
        else:
            byte = byte + 1

        if (byte == 256):
            print("error")

        answer = generate_input(counter, byte)
        sock.sendall((answer + '\n').encode())
        answer = answer.replace("7b7d", getResFlag())
        
        

nc(h, p)
r = ""
for i in resultList:
    r += chr(i)
print(r)


'''
resultList = ['give input:', 'd6f62c3e60e0737e895ba461d7dbc2d2c0c0214a04112414f0de0c543625c91c', '3aab34d97534a0bd60634ef59855b893c0c0214a04112414f0de0c543625c91c', '20bdede2c01672079c482b200fcb0eb8c0c0214a04112414f0de0c543625c91c', 'c2f7ac2d04ca2c6110b70e3b0f44b0e8c0c0214a04112414f0de0c543625c91c', 'e7b8992aa68570f7817d1fe137305495c0c0214a04112414f0de0c543625c91c', '6ad7159bf392b33aba0c2c6009c71dadc0c0214a04112414f0de0c543625c91c', '1f47991433df866083fa5d8c574fb534c0c0214a04112414f0de0c543625c91c', 'b02bfc0d813bedb9effaf92549738d44c0c0214a04112414f0de0c543625c91c', '78722002ca1fb49c9fe8471148e4913cc0c0214a04112414f0de0c543625c91c', '7941a82f8b95426cf90ec9eb352460aec0c0214a04112414f0de0c543625c91c', 'e10012efc5f51e8ff63ee95332cd7944c0c0214a04112414f0de0c543625c91c', 'd6c7237712cd2d85a625918a2ea9b627c0c0214a04112414f0de0c543625c91c', '3687109a9a01566352539b0a260facaac0c0214a04112414f0de0c543625c91c', 'e78a6e6513cd95fb5790a456cf889875c0c0214a04112414f0de0c543625c91c', '09191f23d88d21bf31030e8a6f4f3814c0c0214a04112414f0de0c543625c91c', '9788ad37afae898e5b2d6a9557f9676cc0c0214a04112414f0de0c543625c91c', 'b1d7ae30a9638462a2280accdc9485afc0c0214a04112414f0de0c543625c91c', 'be6e4d0cf54adaba0a7a1715cbbc01a6c0c0214a04112414f0de0c543625c91c', '883886af69c8fc3f413264fb16607c28c0c0214a04112414f0de0c543625c91c', '73bbcb98b2cf1440b972f95318059b73c0c0214a04112414f0de0c543625c91c', 'b04a15e7a77a5c58c4a70124133372d2c0c0214a04112414f0de0c543625c91c', '3d9d3f726fd420f50a7aa4d796abb76bc0c0214a04112414f0de0c543625c91c', 'a0ba5ef5cfac6768d845f0280a3d9401c0c0214a04112414f0de0c543625c91c', '15cf9da8b093ec8f6345a03b0f6f796bc0c0214a04112414f0de0c543625c91c', '4006edf90cefb5b20a0aa36633907844c0c0214a04112414f0de0c543625c91c', '4ffb843b0986f442b094cda3f1caa37bc0c0214a04112414f0de0c543625c91c', 'bb69e3455d65f67e9a2aab139c6e33ffc0c0214a04112414f0de0c543625c91c', '8daec9d40a8c21ecd7da93beffe40b01c0c0214a04112414f0de0c543625c91c', 'bd8ee1ea7925c2ae21ee93e6e61e6143c0c0214a04112414f0de0c543625c91c', 'e16e7e98df63df186b9fff35af1987f9c0c0214a04112414f0de0c543625c91c', 'e3de065a3ecb3155b314806bcafca40ec0c0214a04112414f0de0c543625c91c', '754e62e138b6204fa8bb65764cb377e1c0c0214a04112414f0de0c543625c91c', 'defc21d0b8f12614b2ead55bafb2203cc0c0214a04112414f0de0c543625c91c', '32a1ec10e8a2a4fbe2376a72eca0c20cc0c0214a04112414f0de0c543625c91c', '3c91d8511a92e8c08c66058b234f2da0c0c0214a04112414f0de0c543625c91c', '30912d28c478ffbf8bcfbd1ac2b1fd9fc0c0214a04112414f0de0c543625c91c', '061f5fa47f07de81643ceb49c0b36e0dc0c0214a04112414f0de0c543625c91c', '1078fd0af193a73b3d67b20f329c0f3bc0c0214a04112414f0de0c543625c91c', 'fe51afebf268840defb6496434b4a2a7c0c0214a04112414f0de0c543625c91c', 'ebd36f35e667ce305abbb5bff44ea6bbc0c0214a04112414f0de0c543625c91c', 'b9ff7b9f036841cf59b7ba8ddb3c048cc0c0214a04112414f0de0c543625c91c', '2ecdde3283099e6c6a15eefdb9f84c16c0c0214a04112414f0de0c543625c91c', 'a18f74cc76fd4374bf0490ac5b2ea481c0c0214a04112414f0de0c543625c91c', '8f2da791796d8ac0cf216299156e8b34c0c0214a04112414f0de0c543625c91c', '63b1d6b220baac3af56448d6c42b9e18c0c0214a04112414f0de0c543625c91c', 'a8d1bc664f02a4041d6275a75f26910ec0c0214a04112414f0de0c543625c91c', '07ca57289bd159b5e00db8f2ddfa3b61c0c0214a04112414f0de0c543625c91c', '16196727b9368448686b52840ce030d0c0c0214a04112414f0de0c543625c91c', '36cf4773bfdbef3c83368330f8241586c0c0214a04112414f0de0c543625c91c', 'd549e0f4795e270265503718883040aac0c0214a04112414f0de0c543625c91c', '4437805006275285450272e23f1b27e2c0c0214a04112414f0de0c543625c91c', '0d14597958fd30a85ca2e466e5ed8c1ac0c0214a04112414f0de0c543625c91c', 'd5d06a58634d6a1dee051a7244e145bec0c0214a04112414f0de0c543625c91c', 'd732adf85ae3ecd98a96b387f81c0f61c0c0214a04112414f0de0c543625c91c', '66317aea07abe5e51b200e6a373ee2a1c0c0214a04112414f0de0c543625c91c', 'd89204411fbe4b8a0a202d4450d16b0ec0c0214a04112414f0de0c543625c91c', '30abb2a1f0f5bcf119721b5b17f3dc60c0c0214a04112414f0de0c543625c91c', '7ce20fe5581e48dba3127c2fcffd7032c0c0214a04112414f0de0c543625c91c', '4cfda9639c16dd70b26292f08923bb76c0c0214a04112414f0de0c543625c91c', '342236f8b5a30f91f8b0182fa5d448d4c0c0214a04112414f0de0c543625c91c', 'e545b9bf080d9deecfe33a61b602415fc0c0214a04112414f0de0c543625c91c', '4d722230dac024e9de3fa846d588205dc0c0214a04112414f0de0c543625c91c', '8d0872d8b638d068371dccd764f8fa2dc0c0214a04112414f0de0c543625c91c', '8594d86c878bd3525524cb1d160f2450c0c0214a04112414f0de0c543625c91c', 'eba2ec9fd5147973b81e69b3b5c0bedec0c0214a04112414f0de0c543625c91c', '51eaed868f9dde667434be8e58fabe4ac0c0214a04112414f0de0c543625c91c', '378bd407111c36ffa59afb5c871f59e5c0c0214a04112414f0de0c543625c91c', 'f91e28e3bde94513b78b343bf41cb4cac0c0214a04112414f0de0c543625c91c', 'c77c5f16106f27f15d0b13f29726dc30c0c0214a04112414f0de0c543625c91c', '440aa80dc537dafd5195941dd3461971c0c0214a04112414f0de0c543625c91c', '5cc6ebdc240a982924d40d5ac03958eec0c0214a04112414f0de0c543625c91c', '3d0618ae70fd78cbd613f04a7989d59ac0c0214a04112414f0de0c543625c91c', '46a13510f9a81e31d4fde86c3d3e014ec0c0214a04112414f0de0c543625c91c', '9e9ae5cea06d9bb6d247c9dbbf3a0ec0c0c0214a04112414f0de0c543625c91c', '27119c33e8d87e02a57dbec39c353e61c0c0214a04112414f0de0c543625c91c', 'fea95a899a87cf13bad4d24cca91f8fbc0c0214a04112414f0de0c543625c91c', '16e06d4c7dcd978d9dc882df92630c5bc0c0214a04112414f0de0c543625c91c', '4861ea6f59763f4b8443177ff26b9b79c0c0214a04112414f0de0c543625c91c', '6e7d04b731d3dbd176e4cd8049ea59d3c0c0214a04112414f0de0c543625c91c', '79db8e8864fd3d078f264adfca3367d9c0c0214a04112414f0de0c543625c91c', '28d00e03badf685b670d4ac1676e1323c0c0214a04112414f0de0c543625c91c', 'cc48b1999e54a4f87e1ff80612ad7ed9c0c0214a04112414f0de0c543625c91c', 'dc3173d8be4a560b1ee819449d62d13dc0c0214a04112414f0de0c543625c91c', '511eb6d49edf1bacc5f06cd06aa536d3c0c0214a04112414f0de0c543625c91c', '1f9fe86554214578f28c6d62a7bbdfdfc0c0214a04112414f0de0c543625c91c', '1f241e60b1b57f32dd1afd92bc5a838ec0c0214a04112414f0de0c543625c91c', '96f30d9c22732960300cf0ba2fdb2a39c0c0214a04112414f0de0c543625c91c', '4fda9a78100a5e6ec2722626ff5e461bc0c0214a04112414f0de0c543625c91c', '0eac127794cfc77468f1c45a38640d17c0c0214a04112414f0de0c543625c91c', 'ab2d6c263fb5b5737328e012b6324099c0c0214a04112414f0de0c543625c91c', 'fb1b3e2b2a81e585665909b36def7d45c0c0214a04112414f0de0c543625c91c', 'f511b3c2380064d9b2e3e19320f06eb3c0c0214a04112414f0de0c543625c91c', 'c56b392aeda83afead343d114c58e9f7c0c0214a04112414f0de0c543625c91c', '50bf5e477e1d247b09584dc44d976ab4c0c0214a04112414f0de0c543625c91c', '2e7c58d52c3aa8c46666e91fe95e3079c0c0214a04112414f0de0c543625c91c', '3ae9422444a07f24d1b8cf6d640e231fc0c0214a04112414f0de0c543625c91c', 'f17f10683b8abedcb70274bc6d8bb789c0c0214a04112414f0de0c543625c91c', '6f05cee1029545be7162b24a346c91b7c0c0214a04112414f0de0c543625c91c', 'e1254d6007c018641d0ecb5999d08c08c0c0214a04112414f0de0c543625c91c', '2c199930a6e4b2fa1f867fab091f1f39c0c0214a04112414f0de0c543625c91c', '15cd9ec21fbc855b62d4154527613eaec0c0214a04112414f0de0c543625c91c', 'f86fd23f7abd5248feced4c7ae4951b9c0c0214a04112414f0de0c543625c91c', '28522cd63490effefb8f32023530a565c0c0214a04112414f0de0c543625c91c', '8fef2566d238c2e922c731cd754a11a8c0c0214a04112414f0de0c543625c91c', '71b3a87a4d7c08ca69bcba08ff045c17c0c0214a04112414f0de0c543625c91c', '2f7809368980302da93dc27c30f40500c0c0214a04112414f0de0c543625c91c', '2b8e09eefb3afd25abb73ed8863a982ec0c0214a04112414f0de0c543625c91c', '7ebbcf42c6f262d9c7713817dec09e2bc0c0214a04112414f0de0c543625c91c', '7cd48b7f9e0dc2fdf531b601931516bfc0c0214a04112414f0de0c543625c91c', 'da325aef80e1dd56722eeec9ced9bce8c0c0214a04112414f0de0c543625c91c', '8504df356917197d87bbfde232f027d4c0c0214a04112414f0de0c543625c91c', 'a05ce97b9af296461eafe4e40ad3c1bac0c0214a04112414f0de0c543625c91c', 'f360250dead7e08e82c85486ce01dc90c0c0214a04112414f0de0c543625c91c', '1830703f2205d898aa0b9cb10775ea86c0c0214a04112414f0de0c543625c91c', '91c7854177e31a00072ac939ab2f432ac0c0214a04112414f0de0c543625c91c', '9a5677ed0c979d0b7aa82d4eba83ec38c0c0214a04112414f0de0c543625c91c', '30bdfa27aefa5e7cd6ccebd561151290c0c0214a04112414f0de0c543625c91c', '9170b306b57e8f8de1e1f64b6f1d7563c0c0214a04112414f0de0c543625c91c', '8bfbaa3f72c84e1283b09f5d27e9578dc0c0214a04112414f0de0c543625c91c', 'a5ed0ae73d1ac2b238d3a9bbc8fe57c3c0c0214a04112414f0de0c543625c91c', '843388c5c1e3833ab90ddf33710f4d6bc0c0214a04112414f0de0c543625c91c', '6134b5f981706fbcdf8c82f6b0f7d943c0c0214a04112414f0de0c543625c91c', '9730321c65e711ac6ee4825862518246c0c0214a04112414f0de0c543625c91c', 'ba2a22332e26dd8a8b5f418da3b687aac0c0214a04112414f0de0c543625c91c', '68e8ec3673406367fcc0428d6db21129c0c0214a04112414f0de0c543625c91c', 'b98b5c03946dc3b03050e4c2f357038cc0c0214a04112414f0de0c543625c91c', 'f29cd091850a5dd0d9322d304280d46bc0c0214a04112414f0de0c543625c91c', 'e0e5131418c7031282ab7f5e2f9387d4c0c0214a04112414f0de0c543625c91c', 'cc2f6a55f148d2fd27eb27da24c1a979c0c0214a04112414f0de0c543625c91c', '2e09e3dbc93603a664a20e5630f58cb0c0c0214a04112414f0de0c543625c91c', '9811e54f45431ed6208f90f5afcf67a3c0c0214a04112414f0de0c543625c91c', '48beac47b23f442aec35e8c22d9d5995c0c0214a04112414f0de0c543625c91c', 'c7988b6c1eb3c362648bbce0f70cf650c0c0214a04112414f0de0c543625c91c', '93a0b150c32cd1bb05291ee839a0e3ecc0c0214a04112414f0de0c543625c91c', '36923372c0a87b7809eb3f775d7b0988c0c0214a04112414f0de0c543625c91c', '5f4d9b77269abae77c75ce70e32a7541c0c0214a04112414f0de0c543625c91c', 'cb29e5f15d1345ab49f892fdcb2ed64cc0c0214a04112414f0de0c543625c91c', '2c826f26e209a3bbd1ed26caab5993d6c0c0214a04112414f0de0c543625c91c', '7bda9efd69c188242907c2120942462fc0c0214a04112414f0de0c543625c91c', '6b4349bbc22d1a32158a37e63b135b52c0c0214a04112414f0de0c543625c91c', '780a7ec86f9c755def8252ccea380f43c0c0214a04112414f0de0c543625c91c', 'ada944bdb4e23df852dfde42d90103f1c0c0214a04112414f0de0c543625c91c', '7da68632b36252cf4c3fe5a38de60c7fc0c0214a04112414f0de0c543625c91c', '3817b5363e56cf487dff6c22cd2ebea4c0c0214a04112414f0de0c543625c91c', '85a33bd92c264d934bf2be9620270d23c0c0214a04112414f0de0c543625c91c', 'cfe0bf46258421145f0a8819719f6c8cc0c0214a04112414f0de0c543625c91c', '477d118748b7a45eeacca0eda426ada3c0c0214a04112414f0de0c543625c91c', 'd3cc18f22ecc0a5d172c4502f68f21fbc0c0214a04112414f0de0c543625c91c', 'c6115f56419c65ed2d38cb09061e4862c0c0214a04112414f0de0c543625c91c', '9164e680d1277225c0d89f2b839f91fdc0c0214a04112414f0de0c543625c91c', '05a18d55c11871920453ac60c34cdee3c0c0214a04112414f0de0c543625c91c', '45cfdffcb6d607bac004453d06588aa9c0c0214a04112414f0de0c543625c91c', '1df06573bb7758620354f9e71368b957c0c0214a04112414f0de0c543625c91c', '214c393ea3389446d85bcfb701431cccc0c0214a04112414f0de0c543625c91c', '85aeccbcd5def15770fd34fcb8fed048c0c0214a04112414f0de0c543625c91c', 'aa2b04dcf2af6223fccc468a40c0d5e4c0c0214a04112414f0de0c543625c91c', '961a0e93b8de97c8ea0d160fecdabcbbc0c0214a04112414f0de0c543625c91c', '7641581a15fe09582015c6caadc9225fc0c0214a04112414f0de0c543625c91c', '03553ba9b589ad84ea5b9f899d09ef02c0c0214a04112414f0de0c543625c91c', 'e7288354b956fdc91b2e4c24d3312848c0c0214a04112414f0de0c543625c91c', '6546c32716e3672139c8e5076082f604c0c0214a04112414f0de0c543625c91c', 'a7aee152627c11659ada91effe3fdde7c0c0214a04112414f0de0c543625c91c', '32fd080b2f0e42591ae4a280fa496ae3c0c0214a04112414f0de0c543625c91c', 'f4305af49b85f378ffdf80462145ee27c0c0214a04112414f0de0c543625c91c', 'dfb03136e273d714eb8d56ba2fba24afc0c0214a04112414f0de0c543625c91c', '7ca628c74e525581ad2657c491dc612cc0c0214a04112414f0de0c543625c91c', '565e461eaf3709c589eec04a9c861932c0c0214a04112414f0de0c543625c91c', 'a3e555e4f39b4e8b4a5ba91fb2f4d806c0c0214a04112414f0de0c543625c91c', '0f77456899673fe5beed07e12dbc2c0cc0c0214a04112414f0de0c543625c91c', '336a18dc2878a97ac984a573c33f7cbbc0c0214a04112414f0de0c543625c91c', 'bf4555b653cdbffb3d126d5065dd0263c0c0214a04112414f0de0c543625c91c', 'd613e0e715e214751a5dd9243b76179ac0c0214a04112414f0de0c543625c91c', 'f9cbb3d5d724024d5bc71319d9f1cf09c0c0214a04112414f0de0c543625c91c', '9684124ee01530083dccdc4dc9871487c0c0214a04112414f0de0c543625c91c', 'cbcb3ef751634912b16d7e7d93ecf96ac0c0214a04112414f0de0c543625c91c', 'd1063ea9cd5129c65ed0c3ba78c5672dc0c0214a04112414f0de0c543625c91c', 'f963c38bdca2fe6951f51b1cba4abe1ac0c0214a04112414f0de0c543625c91c', 'b3cc91e198631384683e3c3d9700e1c5c0c0214a04112414f0de0c543625c91c', '3a4dcdc8d68f0e52182a418f90ae1f10c0c0214a04112414f0de0c543625c91c', 'fef1e95dd4dfbe2cba941dde6b9c8a70c0c0214a04112414f0de0c543625c91c', '36ac8a7e3df73836a4336391e9cb8c46c0c0214a04112414f0de0c543625c91c', '66a6917dc7e636ae13bea57968bae1c0c0c0214a04112414f0de0c543625c91c', '2b9c629de5603afbf5402fa24de593fbc0c0214a04112414f0de0c543625c91c', '48b4bc9ecab838d017c97f201d5f3a8bc0c0214a04112414f0de0c543625c91c', 'b3d24d2bcc40631366acc79968575126c0c0214a04112414f0de0c543625c91c', 'b69bc1c6bb7bf3418287dff7ddbe66fcc0c0214a04112414f0de0c543625c91c', '412d55906e385918dc69200a63109bbec0c0214a04112414f0de0c543625c91c', '691619cb150fbc6bc063602266e544f5c0c0214a04112414f0de0c543625c91c', 'd9f2591e08e449d12c12f8dce02d8f53c0c0214a04112414f0de0c543625c91c', 'd9da66b7c61ce254162c41f4130474e4c0c0214a04112414f0de0c543625c91c', 'aba4b9c8ad1c878f2d6edcf3d224ca20c0c0214a04112414f0de0c543625c91c', '8b6d0c25e2aed42a99f8cc4325d7c692c0c0214a04112414f0de0c543625c91c', 'd0825231984c9661f2b1c707697cb889c0c0214a04112414f0de0c543625c91c', '9669605e7e8dfe21776e2c207cf54124c0c0214a04112414f0de0c543625c91c', '734b371d5be953ebf1bb6dd1735716dcc0c0214a04112414f0de0c543625c91c', '124f932f4a89ff7b871146941182956cc0c0214a04112414f0de0c543625c91c', '9f1fc1caec5c72e1bfa82d11a411791dc0c0214a04112414f0de0c543625c91c', '4aeafe9d5c096460fb53481df7b7cdd7c0c0214a04112414f0de0c543625c91c', '345abbc281ce88496fdb1171f658b1afc0c0214a04112414f0de0c543625c91c', '0aa472a7a4ef76e44ef3cf0424477f2fc0c0214a04112414f0de0c543625c91c']]
'''

# actf{cbc_more_like_ecb_c}